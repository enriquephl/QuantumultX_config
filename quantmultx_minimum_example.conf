[general]
# IP_API
geo_location_checker=http://ip-api.com/json/?lang=zh-CN, https://raw.githubusercontent.com/Orz-3/Orz-3/master/QuantumultX/IP.js

# 资源解析器
resource_parser_url=https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/resource-parser.js

# 排除路线
excluded_routes = 239.255.255.250/32, 24.105.30.129/32, 185.60.112.157/32, 185.60.112.158/32, 182.162.132.1/32

# UDP Allow Ports
udp_whitelist = 53,123,81-442,444-5331,5334-65535

# DNS 排除列表
dns_exclusion_list = *.cmpassport.com, *.jegotrip.com.cn, *.icitymobile.mobi, id6.me, *.pingan.com.cn, *.cmbchina.com, *.npln.srv.nintendo.net, stun.l.google.com, stun*.l.google.com

[dns]
prefer-doh3
no-system
;no-ipv6
doq-server = quic://223.5.5.5, quic://223.6.6.6
doh-server = https://doh.pub/dns-query, https://doh.360.cn/dns-query
doh-server = /*.icloud-content.com/https://doh.pub/dns-query
server = /xp.apple.com/system
server = /captive.apple.com/system
server = /netcts.cdn-apple.com/system
server = /*.hdslb.com/system
server = /*.bilivideo.com/system
server = /*.wechat.com/system
server = /*.weixin.com/system
server = /*.weixin.qq.com/system
server = /*.weixin.qq.com.cn/system
server = /*.qpic.cn/system
server = /*.qlogo.cn/system
server = /*.xhscdn.com/system
server = 119.29.29.29
server = 8.8.8.8
alias = /iosapps.itunes.apple.com/iosapps.itunes.apple.com.download.ks-cdn.com
server = /router.asus.com/system
server = /asusrouter.com/system
server = /*.asusrouter.com/system
alias = /metrics-picture.d.meituan.net/metrics-picture.dreport.meituan.net

[policy]
# 请根据自身机场情况调整 regex 规则
static = EU, server-tag-regex=Germany|Kingdom|France|Netherlands|Ireland|Belgium|Finland|Norway|Sweden|Spain|Hungary|Romania|Ukraine, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/European_Union.png
static = HK, server-tag-regex=香港|HK|HongKong, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
static = JP, server-tag-regex=日本|Japan, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/ColorJapan.png
static = SG, server-tag-regex=新加坡|Singapore, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
static = TW, server-tag-regex=台|Taiwan, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Taiwan.png
;static = TW_ISP, hinet01, proxy, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/TW.png
static = US, server-tag-regex=美|States, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png
;static=Bilibili, direct, HK, TW, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/bilibili.png
;static=Line, HK, JP, SG, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Line.png
;static=WeChat, direct, HK, SG, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/WeChat.png
static=YouTube, proxy, EU, HK, JP, SG, TW, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
;static=YouTubeCDN, YouTube, HK, JP, SG, TW, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube_Letter.png
;static=iCloud, direct, HK, JP, SG, TW, US, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/iCloud.png
;static=LocationServices, direct, proxy, EU, HK, JP, SG, TW, US, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Find_My.png
;static=News, US, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple_News.png

[server_remote]
; 添加你的机场订阅链接

[filter_remote]
; 修正补丁
https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/snippets/Whitelist.snippet, tag=Whitelist, enabled=true
; 拦劫隱私追踪器和 PCDN tracker
; NoMalwares 和 NoMalwaresPlus 择一启用
https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/NoMalwares.conf, tag=NoMalwares, force-policy=reject, enabled=true
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/NoMalwaresPlus.list, tag=NoMalwaresPlus, force-policy=reject, enabled=true
https://raw.githubusercontent.com/Elysian-Realme/FuGfConfig/main/ConfigFile/QuantumultX/FuckRogueSoftwareRules.conf, tag=Privacy, force-policy=reject, enabled=true
https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/reject-no-drop.conf, tag=RejectNoDrop, force-policy=reject, opt-parser=true, enabled=true
; Apple 域名处理
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/snippets/AppleExtra.snippet, tag=AppleExtra, enabled=true
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/AppleIntelligence.conf#via=0, tag=AppleIntelligence, force-policy=TW_ISP, update-interval=172800, opt-parser=true, enabled=true
;https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/domainset/icloud_private_relay.conf#type=domain-set, tag=iCloudPrivateRelay, force-policy=proxy, opt-parser=true, enabled=true
https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/apple_cn.conf, tag=AppleCN, force-policy=direct, opt-parser=true, enabled=true
https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/apple_cdn.conf, tag=AppleCDN, force-policy=direct, opt-parser=true, enabled=true
https://raw.githubusercontent.com/Elysian-Realme/FuGfConfig/main/ConfigFile/QuantumultX/Apple/AppleNoChinaCDNRules.conf, tag=AppleNoChinaCDN, force-policy=proxy, enabled=true
https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/apple_services.conf, tag=AppleServices, force-policy=direct, opt-parser=true, enabled=true
; 国内直连部分
https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/snippets/EmailDirect.snippet, tag=EmailDirect, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/SteamCN/SteamCN.list, tag=SteamCN, force-policy=direct, enabled=true
https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/microsoft_cdn.conf, tag=MicrosoftCDN, force-policy=direct, opt-parser=true, enabled=true
;https://raw.githubusercontent.com/Elysian-Realme/FuGfConfig/main/ConfigFile/QuantumultX/MicrosoftRules.conf, tag=MicrosoftDirect, force-policy=direct, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/OneDrive/OneDrive.list, tag=OneDrive, force-policy=direct, enabled=true
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/snippets/Bilibili.snippet, tag=Bilibili, enabled=true
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/snippets/Xiaohongshu.snippet, tag=Xiaohongshu, enabled=true
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/snippets/Wechat.snippet, tag=Wechat, enabled=true
https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/domestic.conf, tag=Domestic, force-policy=direct, opt-parser=true, enabled=true
; Telegram
https://raw.githubusercontent.com/enriquephl/telegram_ips/main/TelegramUS.list, tag=TelegramUS, force-policy=US, enabled=true
https://raw.githubusercontent.com/enriquephl/telegram_ips/main/TelegramSG.list, tag=TelegramSG, force-policy=SG, enabled=true
https://raw.githubusercontent.com/enriquephl/telegram_ips/main/TelegramNL.list, tag=TelegramNL, force-policy=EU, enabled=true
; Web3
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/ClashRuleSet/Clash/Web3.list#via=0, tag=Web3, force-policy=TW_ISP, update-interval=172800, opt-parser=true, enabled=true
; 家宽 + 代理链分流 AI 和流媒体
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/UnbanAirport.conf#via=0, tag=UnbanAirport, force-policy=TW_ISP, update-interval=172800, opt-parser=true, enabled=true
;https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/ai.conf#via=0, tag=AIPlatforms, force-policy=TW_ISP, update-interval=172800, opt-parser=true, enabled=true
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/InstagramUnblock.conf#via=0, tag=InstagramUnblock, force-policy=TW_ISP, update-interval=172800, opt-parser=true, enabled=true
; 流媒体 CDN
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/MediaCDNs.list, tag=MediaCDNs, force-policy=proxy, enabled=true
https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/snippets/MediaCDNExtra.snippet, tag=MediaCDNExtra, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Spotify/Spotify.list, tag=Spotify, force-policy=proxy, enabled=true
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/YouTubeCDNs.conf, tag=YoutubeCDNs, force-policy=YouTubeCDN, enabled=true
https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/YouTube.list, tag=YouTube, force-policy=YouTube, enabled=true
; for GDPR purposes
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/GoogleAPIs.conf, tag=GoogleAPIs, force-policy=EU, enabled=true
;https://raw.githubusercontent.com/enriquephl/QuantumultX_config/main/filters/MetaAPIs.conf, tag=MetaAPIs, force-policy=EU, enabled=true
; Nintendo
;https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Nintendo/Nintendo.list, tag=Nintendo, force-policy=HK, enabled=true
; 流媒体
;https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/stream_hk.conf, tag=StreamHK, force-policy=HK, opt-parser=true, enabled=true
;https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/stream_jp.conf, tag=StreamJP, force-policy=JP, opt-parser=true, enabled=true
;https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/stream_tw.conf, tag=StreamTW, force-policy=TW, opt-parser=true, enabled=true
;https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/stream_us.conf, tag=StreamUS, force-policy=US, opt-parser=true, enabled=true
;https://raw.githubusercontent.com/SukkaLab/ruleset.skk.moe/master/List/non_ip/stream.conf#via=0, tag=ForeignMedia, force-policy=TW_ISP, update-interval=172800, opt-parser=true, enabled=true
; 直连兜底
FILTER_LAN, tag=LAN, force-policy=direct, enabled=true
FILTER_REGION, tag=CN, force-policy=direct, enabled=true

[rewrite_remote]
;https://raw.githubusercontent.com/fmz200/wool_scripts/main/QuantumultX/rewrite/rewrite.snippet, tag=NoAdvertising, update-interval=172800, opt-parser=false, enabled=true
;https://github.com/NSRingo/GeoServices/releases/latest/download/iRingo.Location.snippet, tag=iRingoLocation, update-interval=172800, opt-parser=false, enabled=true
;https://github.com/NSRingo/Siri/releases/latest/download/iRingo.Siri.snippet, tag=iRingoSiri, update-interval=172800, opt-parser=false, enabled=true
;https://github.com/NSRingo/News/releases/latest/download/iRingo.News.snippet, tag=iRingoNews, update-interval=172800, opt-parser=false, enabled=true
;https://github.com/NSRingo/TV/releases/latest/download/iRingo.TV.snippet, tag=iRingoTV, update-interval=172800, opt-parser=false, enabled=true
;https://github.com/chavyleung/scripts/raw/master/box/rewrite/boxjs.rewrite.quanx.conf, tag=BoxJs, update-interval=172800, opt-parser=false, enabled=true

[server_local]

[filter_local]
; Line app 规则，实测发现 Line 在东亚仅有 SG/JP 节点
; host-suffix, line-apps.com, Line
; 避免特殊时期 dns 分流失误
host-suffix, github.com, proxy
host-suffix, githubusercontent.com, proxy
host, www.google.com, proxy
final, proxy

[rewrite_local]

[task_local]

[http_backend]

[mitm]
